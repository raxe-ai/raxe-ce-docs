---
title: "CLI Commands"
description: "Complete command reference"
---

## raxe scan

Scan text for threats.

```bash
raxe scan "text to scan"
```

### Options

| Option | Description |
|--------|-------------|
| `--format` | Output format: `text`, `json` |
| `--ci` | CI mode (JSON + exit code 1 on threats) |
| `--explain` | Show detailed explanations |
| `--rule` | Test specific rule only |
| `--tenant` | Tenant ID for multi-tenant scanning |
| `--app` | App ID within tenant |
| `--policy` | Override policy for this scan |

### Examples

```bash
# Basic scan
raxe scan "Ignore all previous instructions"

# JSON output
raxe scan "text" --format json

# CI mode
raxe scan "text" --ci

# With explanations
raxe scan "text" --explain

# Multi-tenant scanning
raxe scan "text" --tenant acme --app chatbot

# Override policy
raxe scan "text" --tenant acme --policy strict
```

---

## raxe batch

Scan multiple prompts from file.

```bash
raxe batch prompts.txt
```

### Options

| Option | Description |
|--------|-------------|
| `--format` | Output format: `text`, `json`, `csv` |
| `--output` | Write results to file |

### Examples

```bash
# Scan from file
raxe batch prompts.txt

# Output to JSON file
raxe batch prompts.txt --format json --output results.json

# From stdin
cat prompts.txt | raxe batch -
```

---

## raxe repl

Interactive scanning mode.

```bash
raxe repl
```

### REPL Commands

| Command | Description |
|---------|-------------|
| `scan <text>` | Scan text |
| `rules` | List loaded rules |
| `stats` | Show session stats |
| `clear` | Clear screen |
| `help` | Show help |
| `quit` | Exit REPL |

---

## raxe rules

Manage detection rules.

```bash
raxe rules list
raxe rules show <rule-id>
```

### Subcommands

| Command | Description |
|---------|-------------|
| `list` | List all rules |
| `show <id>` | Show rule details |
| `search <query>` | Search rules |

### Examples

```bash
# List all rules
raxe rules list

# Filter by family
raxe rules list --family PI

# Show specific rule
raxe rules show pi-001

# Search rules
raxe rules search "injection"
```

---

## raxe doctor

System health check.

```bash
raxe doctor
```

### Output

```
RAXE Health Check

 Configuration file exists
 Rules loaded successfully (514 rules)
 Database initialized
 ML model available
 Telemetry endpoint reachable

System ready!
```

---

## raxe stats

View scan statistics.

```bash
raxe stats
```

### Options

| Option | Description |
|--------|-------------|
| `--period` | Time period: `today`, `week`, `month`, `all` |

### Output

```
RAXE Statistics (This Week)

Scans: 1,234
Threats Detected: 56
Detection Rate: 4.5%

Top Rules:
  1. pi-001 (23 detections)
  2. jb-003 (12 detections)
  3. pii-042 (8 detections)
```

---

## raxe config

Manage configuration.

```bash
raxe config show
raxe config set <key> <value>
```

### Subcommands

| Command | Description |
|---------|-------------|
| `show` | Show current config |
| `set <key> <value>` | Set config value |
| `reset` | Reset to defaults |

### Examples

```bash
# Show config
raxe config show

# Set log level
raxe config set log_level DEBUG

# Reset config
raxe config reset
```

---

## raxe init

Initialize RAXE configuration.

```bash
raxe init
```

Creates:
- `~/.raxe/config.yaml`
- `~/.raxe/raxe.db`

---

## raxe export

Export scan history.

```bash
raxe export --format json --output history.json
```

### Options

| Option | Description |
|--------|-------------|
| `--format` | Output format: `json`, `csv` |
| `--output` | Output file path |
| `--since` | Export from date |

---

## raxe tenant

Manage tenants for multi-customer deployments.

```bash
raxe tenant <subcommand>
```

### Subcommands

| Command | Description |
|---------|-------------|
| `create` | Create a new tenant |
| `list` | List all tenants |
| `show <id>` | Show tenant details |
| `delete <id>` | Delete a tenant |

### Examples

```bash
# Create a tenant
raxe tenant create --name "Acme Corp" --id acme

# Create with strict policy
raxe tenant create --name "Security Team" --id security --policy strict

# List tenants
raxe tenant list
raxe tenant list --output json

# Delete tenant
raxe tenant delete acme --force
```

---

## raxe app

Manage applications within tenants.

```bash
raxe app <subcommand>
```

### Subcommands

| Command | Description |
|---------|-------------|
| `create` | Create a new app |
| `list` | List apps for a tenant |
| `show <id>` | Show app details |
| `delete <id>` | Delete an app |

### Examples

```bash
# Create an app
raxe app create --tenant acme --name "Chatbot" --id chatbot

# Create with strict policy
raxe app create --tenant acme --name "Trading" --id trading --policy strict

# List apps
raxe app list --tenant acme

# Show details
raxe app show chatbot --tenant acme
```

---

## raxe policy

Manage security policies for tenants.

```bash
raxe policy <subcommand>
```

### Subcommands

| Command | Description |
|---------|-------------|
| `list` | List available policies |
| `set <policy>` | Set default policy |
| `explain` | Show policy resolution |
| `create` | Create custom policy |

### Examples

```bash
# List policies (presets + custom)
raxe policy list --tenant acme

# Set tenant default
raxe policy set balanced --tenant acme

# Set app-specific policy
raxe policy set strict --tenant acme --app trading

# Explain resolution chain
raxe policy explain --tenant acme --app trading
```

### Policy Modes

| Mode | Behavior |
|------|----------|
| `monitor` | Never blocks, logs everything |
| `balanced` | Blocks CRITICAL, HIGH with confidence ≥ 0.85 |
| `strict` | Blocks CRITICAL, HIGH, and MEDIUM |

---

## raxe suppress

Manage suppression rules for false positives.

```bash
raxe suppress <subcommand>
```

### Subcommands

| Command | Description |
|---------|-------------|
| `list` | List all active suppressions |
| `add <pattern>` | Add a new suppression |
| `remove <pattern>` | Remove a suppression |
| `audit` | View suppression audit log |

### Examples

```bash
# List all suppressions
raxe suppress list

# Add a suppression with reason
raxe suppress add pi-001 --reason "Known false positive in auth flow"

# Add with expiration
raxe suppress add "jb-*" --reason "Test suite" --expires 2025-06-01

# Tenant-scoped suppression
raxe suppress add pi-001 --tenant acme --reason "Tenant-specific false positive"
raxe suppress list --tenant acme

# Remove a suppression
raxe suppress remove pi-001

# View audit log
raxe suppress audit
```

### Options for `add`

| Option | Description |
|--------|-------------|
| `--reason` | Required reason for the suppression |
| `--expires` | Expiration date (ISO 8601 format) |
| `--action` | Override action: `SUPPRESS`, `FLAG`, `LOG` |
| `--tenant` | Tenant ID for tenant-scoped suppression |

---

## raxe validate-rule

Validate a custom rule file.

```bash
raxe validate-rule path/to/rule.yaml
```

### Output

```
Validating rule.yaml...

 YAML syntax valid
 Schema compliance OK
 Pattern compiles successfully
 No catastrophic backtracking
 Examples pass

Rule is valid!
```

---

## raxe mssp

Manage MSSPs for partner deployments.

```bash
raxe mssp <subcommand>
```

### Subcommands

| Command | Description |
|---------|-------------|
| `create` | Create a new MSSP |
| `list` | List all MSSPs |
| `show <id>` | Show MSSP details |
| `test-webhook <id>` | Test webhook connectivity |
| `delete <id>` | Delete an MSSP |
| `cleanup` | Clean up old audit logs |

### Create Options

| Option | Description |
|--------|-------------|
| `--id` | MSSP identifier (must start with `mssp_`) |
| `--name` | Human-readable MSSP name |
| `--webhook-url` | Webhook endpoint URL (HTTPS required) |
| `--webhook-secret` | Shared secret for HMAC signing |
| `--tier` | Subscription tier: `starter`, `professional`, `enterprise` (default: starter) |
| `--max-customers` | Maximum customers allowed (default: 10) |

### Examples

```bash
# Create MSSP with webhook
raxe mssp create --id mssp_yourcompany \
    --name "Your Security Services" \
    --webhook-url https://soc.company.com/raxe/alerts \
    --webhook-secret your_secret_here \
    --tier starter \
    --max-customers 10

# List MSSPs
raxe mssp list

# Show details
raxe mssp show mssp_yourcompany

# Test webhook
raxe mssp test-webhook mssp_yourcompany

# Delete MSSP
raxe mssp delete mssp_yourcompany --force
```

---

## raxe customer

Manage customers within an MSSP.

```bash
raxe customer <subcommand>
```

### Subcommands

| Command | Description |
|---------|-------------|
| `create` | Create a new customer |
| `list` | List customers for an MSSP |
| `show <id>` | Show customer details |
| `configure <id>` | Update customer settings |
| `delete <id>` | Delete a customer |

### Examples

```bash
# Create customer with full data mode
raxe customer create --mssp mssp_yourcompany --id cust_acme \
    --name "Acme Corporation" \
    --data-mode full \
    --retention-days 60

# Create privacy-safe customer
raxe customer create --mssp mssp_yourcompany --id cust_privacy \
    --name "Privacy Corp" \
    --data-mode privacy_safe

# List customers
raxe customer list --mssp mssp_yourcompany

# Show details
raxe customer show --mssp mssp_yourcompany cust_acme

# Update configuration
raxe customer configure cust_acme --mssp mssp_yourcompany \
    --data-mode privacy_safe \
    --retention-days 90

# Delete customer
raxe customer delete --mssp mssp_yourcompany cust_acme --force
```

### Configuration Options

| Option | Description |
|--------|-------------|
| `--data-mode` | `full` or `privacy_safe` |
| `--retention-days` | Data retention (0-90 days) |
| `--heartbeat-threshold` | Seconds before agent marked offline |

### SIEM Subcommands

```bash
raxe customer siem configure <id> --mssp <mssp_id> --type <type> --url <url> --token <token>
raxe customer siem show <id> --mssp <mssp_id>
raxe customer siem test <id> --mssp <mssp_id>
raxe customer siem disable <id> --mssp <mssp_id>
```

### SIEM Configuration Examples

```bash
# Splunk HEC
raxe customer siem configure cust_acme --mssp mssp_yourcompany \
    --type splunk \
    --url https://splunk.company.com:8088/services/collector/event \
    --token "hec-token"

# CEF over HTTP
raxe customer siem configure cust_acme --mssp mssp_yourcompany \
    --type cef \
    --url https://collector.company.com/cef \
    --token "bearer-token"

# CEF over Syslog UDP
raxe customer siem configure cust_acme --mssp mssp_yourcompany \
    --type cef \
    --url syslog://siem.company.com \
    --transport udp --port 514

# CEF over Syslog TCP with TLS
raxe customer siem configure cust_acme --mssp mssp_yourcompany \
    --type cef \
    --url syslog://siem.company.com \
    --transport tcp --port 6514 --tls

# ArcSight SmartConnector
raxe customer siem configure cust_acme --mssp mssp_yourcompany \
    --type arcsight \
    --url https://arcsight.company.com/receiver/v1/events \
    --token "connector-token" \
    --smart-connector-id sc-001
```

### SIEM Types

| Type | Description |
|------|-------------|
| `splunk` | Splunk HTTP Event Collector |
| `crowdstrike` | CrowdStrike Falcon LogScale |
| `sentinel` | Microsoft Sentinel |
| `cef` | Generic CEF (HTTP or Syslog) |
| `arcsight` | ArcSight SmartConnector |

---

## raxe agent

Manage agents deployed at customer sites.

```bash
raxe agent <subcommand>
```

### Subcommands

| Command | Description |
|---------|-------------|
| `register` | Register a new agent |
| `list` | List agents for an MSSP |
| `status <id>` | Show agent status |
| `heartbeat <id>` | Send agent heartbeat |
| `unregister <id>` | Unregister an agent |

### Examples

```bash
# Register agent
raxe agent register --mssp mssp_yourcompany --customer cust_acme \
    --version 0.10.0 agent_prod_001

# List agents
raxe agent list --mssp mssp_yourcompany
raxe agent list --mssp mssp_yourcompany --customer cust_acme

# Show agent status
raxe agent status --mssp mssp_yourcompany --customer cust_acme agent_prod_001

# Send heartbeat
raxe agent heartbeat agent_prod_001

# Unregister agent
raxe agent unregister agent_prod_001 --force
```

### Status Output

```
       Agent Status: agent_prod_001
┌────────────────┬─────────────────────┐
│ Agent ID       │ agent_prod_001      │
│ Status         │ online              │
│ MSSP           │ mssp_yourcompany    │
│ Customer       │ cust_acme           │
│ Version        │ 0.10.0              │
│ Platform       │ darwin              │
│ Last Heartbeat │ 2026-01-30T11:30:00 │
│ Total Scans    │ 1250                │
│ Total Threats  │ 23                  │
└────────────────┴─────────────────────┘
```
